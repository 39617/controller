<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>Controller: E:/ISEL Projects/controller/contiki_multiple_interface/platform/cc2538dk/README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Controller
   </div>
   <div id="projectbrief">IOT Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">E:/ISEL Projects/controller/contiki_multiple_interface/platform/cc2538dk/README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="platform_2cc2538dk_2README_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Getting Started with Contiki for TI CC2538DK</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;============================================</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;This guide&#39;s aim is to help you start using Contiki for TI&#39;s CC2538 Development Kit. By</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;CC2538DK we mean a TI CC2538 Evaluation Module (EM), either standalone and powered by USB or attached to a SmartRF06 Evaluation Board (EB) or Battery Board (BB). The general usage scenario assumes that the EM is attached to a SmartRF06EB and is powered by it.</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;This guide assumes that you have basic understanding of how to use the command line and perform basic admin tasks on UNIX family OSs.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Port Features</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;=============</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;The platform has the following key features:</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; * Deep Sleep support with RAM retention for ultra-low energy consumption.</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; * Native USB support (CDC-ACM). SLIP over UART for border routers is no longer a bottleneck.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; * DMA transfers for increased performance (RAM to/from RF, RAM to/from USB).</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;In terms of hardware support, the following drivers have been implemented:</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  * CC2538 System-on-Chip:</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    * Standard Cortex M3 peripherals (NVIC, SCB, SysTick)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    * Sleep Timer (underpins rtimers)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    * SysTick (underpins the platform clock and Contiki&#39;s timers infrastructure)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    * RF</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    * UART</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    * Watchdog (in watchdog mode)</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    * USB (in CDC-ACM)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    * uDMA Controller (RAM to/from USB and RAM to/from RF)</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    * Random number generator</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    * Low Power Modes</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    * General-Purpose Timers. NB: GPT0 is in use by the platform code, the remaining GPTs are available for application development.</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    * ADC</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    * PWM</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    * Cryptoprocessor (AES-ECB/CBC/CTR/CBC-MAC/GCM/CCM-128/192/256, SHA-256)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    * Public Key Accelerator (ECDH, ECDSA)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    * Flash-based port of Coffee</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  * SmartRF06 EB and BB peripherals</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    * LEDs</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    * Buttons</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    * ADC sensors (on-chip VDD / 3 and temperature, ambient light sensor)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    * UART connectivity over the XDS100v3 backchannel (EB only)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;Requirements</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;============</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;To start using Contiki, you will need the following:</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; * A toolchain to compile Contiki for the CC2538.</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; * Drivers so that your OS can communicate with your hardware.</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; * Software to upload images to the CC2538.</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;Different tasks can be performed under different operating systems. The table below summarises what task can be performed on which OS:</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                       Windows     Linux     OS-X</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    Building Contiki      Y          Y         Y</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    Node Programming      Y          Y         Y</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    Console output</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      (UART)              Y          Y         Y</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      (USB CDC-ACM)       Y          Y         Y</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    Border Routers</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      (UART)              N          Y         Y</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      (USB CDC-ACM)       N          Y         Y</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    Sniffer</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      (UART)              N          Y         Y</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      (USB CDC-ACM)       N          Y         Y</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;The platform has been developed and tested under Windows XP, Mac OS X 10.9.1 and Ubuntu 12.04 and 12.10. The matrix above has been populated based on information for those OSs.</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;Install a Toolchain</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;-------------------</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;The toolchain used to build contiki is arm-gcc, also used by other arm-based Contiki ports. If you are using Instant Contiki, you may have a version pre-installed in your system.</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;The platform is currently being used/tested with &quot;GNU Tools for ARM Embedded Processors&quot; (&lt;https://launchpad.net/gcc-arm-embedded&gt;). The current recommended version and the one being used by Contiki&#39;s regression tests on Travis is shown below.</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    $ arm-none-eabi-gcc --version</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    arm-none-eabi-gcc (GNU Tools for ARM Embedded Processors) 5.2.1 20151202 (release) [ARM/embedded-5-branch revision 231848]</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    Copyright (C) 2015 Free Software Foundation, Inc.</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    This is free software; see the source for copying conditions.  There is NO</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;Drivers</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;-------</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;You will need to install drivers so that your Operating System can communicate with the hardware</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;### For the SmartRF06 EB (UART)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;The SmartRF communicates with the PC with a piece of hardware called the TI XDS100v3 Emulator (from now on simply XDS). This is a combined JTAG/UART interface and is used to program the EM, for debugging and for UART character I/O.</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;You will need to install XDS drivers if you want to do anything useful with the CC2538 UART.</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  * **For Windows**: Installing [SmartRF Studio][smart-rf-studio] will install the drivers (A beta version is needed, not the one currently distributed on the TI site). Read the [SmartRF User Guide][smart-rf-ug] for more detailed instructions. After driver installation, the XDS will appear as a COM port.</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  * **For Linux**: The XDS is based on an FTDI chip and new Linux kernels provide very good support for FTDI chips. If the kernel module does not kick in automatically, perform the following steps:</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    * Connect the SmartRF to the linux box. Find the device&#39;s VID and PID (0403:a6d1 in the output below):</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            $ lsusb</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            ...</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            Bus 001 Device 002: ID 0403:a6d1 Future Technology Devices International, Ltd</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            ...</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    * As root or with `sudo`, run the command below (if necessary, replace the `vendor` and `product` arguments with the values you got from `lsusb`):</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            modprobe ftdi_sio vendor=0x403 product=0xa6d1</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            </div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    * From Kernel 3.12 run the command below:</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            modprobe ftdi_sio</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            echo 0403 a6d1 &gt; /sys/bus/usb-serial/drivers/ftdi_sio/new_id</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    * You may have have to remove package `brltty`, if it&#39;s installed.</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    * The board should have enumerated as `/dev/ttyUSB{0,1}`. `ttyUSB1` will be the UART backchannel.</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  * **For OS X**: We need to hack the kernel extension (kext) a little bit:</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    * First, install the FTDI VCP driver from &lt;http://www.ftdichip.com/Drivers/VCP.htm&gt;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    * Edit `/System/Library/Extensions/FTDIUSBSerialDriver.kext/Contents/Info.plist` with a text editor.</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    * Add the following block somewhere under `IOKitPersonalities`.</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            &lt;key&gt;TI_XDS100v3&lt;/key&gt;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            &lt;dict&gt;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            &lt;key&gt;CFBundleIdentifier&lt;/key&gt;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;              &lt;string&gt;com.FTDI.driver.FTDIUSBSerialDriver&lt;/string&gt;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;              &lt;key&gt;IOClass&lt;/key&gt;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              &lt;string&gt;FTDIUSBSerialDriver&lt;/string&gt;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;              &lt;key&gt;IOProviderClass&lt;/key&gt;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;              &lt;string&gt;IOUSBInterface&lt;/string&gt;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              &lt;key&gt;bConfigurationValue&lt;/key&gt;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;              &lt;integer&gt;1&lt;/integer&gt;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;              &lt;key&gt;bInterfaceNumber&lt;/key&gt;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;              &lt;integer&gt;1&lt;/integer&gt;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;              &lt;key&gt;idProduct&lt;/key&gt;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              &lt;integer&gt;42705&lt;/integer&gt;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;              &lt;key&gt;idVendor&lt;/key&gt;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              &lt;integer&gt;1027&lt;/integer&gt;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            &lt;/dict&gt;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    * If the kext is loaded at the time you perform this change, you will have to either reload it or reboot the Mac. At the time of writing this guide, reloading the kext would fail with errors so rebooting appears to be the only solution.</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    * After you have rebooted, plug in the SmartRF, turn it on and then load the kext manually:</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            sudo kextload /System/Library/Extensions/FTDIUSBSerialDriver.kext</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;If everything worked, the XDS will have enumerated as `/dev/tty.usbserial-&lt;serial-number&gt;`</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;### For the CC2538EM (USB CDC-ACM)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;The CC2538 EM&#39;s USB Vendor and Product IDs are the following:</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  * VID 0x0451</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  * PID 0x16C8</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;The implementation in Contiki is pure CDC-ACM: The Linux and OS X kernels know exactly what to do and drivers are not required.</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;On windows, you will need to provide a driver. You have two options:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  * Use the signed or unsigned driver provided by TI in [CC2538 Foundation Firmware](http://www.ti.com/tool/cc2538-sw). You will find them both under the `drivers` directory.</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  * Download a generic Virtual Serial Port driver and modify it so it works for the CC2538.</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;For the latter option:</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  * Download this [LUFA CDC-ACM driver](https://raw.githubusercontent.com/abcminiuser/lufa/master/Demos/Device/LowLevel/VirtualSerial/LUFA%20VirtualSerial.inf).</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  * Adjust the VID and PID near the end with the values at the start of this section.</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  * Next time you get prompted for the driver, include the directory containing the .inf file in the search path and the driver will be installed.</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;### Improve Stability on Linux</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;There are some issues under recent Ubuntu versions (e.g. 12.10). The problem manifests itself as frequent connects/disconnects for the first approximately 30 seconds after the device has been connected to the host (Both UART and USB). The reason for this is that, as soon as the device is connected, the modem manager kicks in and starts probing it. To prevent this, we can tell the modem manager to leave this device alone:</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;* edit `/lib/udev/rules.d/77-mm-usb-device-blacklist.rules`</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;* Add the following line somewhere:</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        ATTRS{idVendor}==&quot;0451&quot;, ATTRS{idProduct}==&quot;16c8&quot;, ENV{ID_MM_DEVICE_IGNORE}=&quot;1&quot;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;* This line will instruct modem-manager to ignore the EM&#39;s USB port. To achieve the same for the SmartRF&#39;s XDS port, add a similar line but replace `idVendor` and `idProduct` with the XDS&#39; VID/PID: 0403/a6d1.</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;* restart the modem-manager process:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        sudo service modemmanager restart</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;This will tell modem manager to suppress probing for these VID/PID combinations. Keep in mind that the `blacklist.rules` file may get overwritten by future modem-manager updates and you may have to re-apply the fix in the future.</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;### Jumper Settings</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;Be careful with jumper settings on the CC2538 EM. The EM can be powered from the SmartRF or it can be powered from its own USB port.</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;* Locate the pair of adjacent jumpers on the EM.</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;* To power the EM from the SmartRF, place the jumper on the inner two pins (the ones closest to the SoC).</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;* To power the EM from its USB, place the jumper on the two pins nearest to the USB port.</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;The USB functionality will work on both situations, the jumper only controlls power supply.</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;### Device Enumerations</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;For the UART, serial line settings are 115200 8N1, no flow control.</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;Once all drivers have been installed correctly:</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;On windows, devices will appear as a virtual COM port (applies to both the UART/XDS as well as USB CDC-ACM).</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;On Linux and OS X, devices will appear under `/dev/`.</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;On OS X:</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;* XDS backchannel: `tty.usbserial-&lt;serial number&gt;`</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;* EM in CDC-ACM: `tty.usbmodemf&lt;X&gt;&lt;ABC&gt;` (X a letter, ABC a number e.g. `tty.usbmodemfd121`)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;On Linux:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;* XDS backchannel: `ttyUSB1`</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;* EM in CDC-ACM: `ttyACMn` (n=0, 1, ....)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;Software to Program the Nodes</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;-----------------------------</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;The CC2538 can be programmed via the jtag interface or via the serial boot loader on the chip.</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;* On Windows:</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    * Nodes can be programmed with TI&#39;s ArmProgConsole or the [SmartRF Flash Programmer 2][smart-rf-flashprog]. The README should be self-explanatory. With ArmProgConsole, upload the file with a `.bin` extension. (jtag + serial)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    * Nodes can also be programmed via the serial boot loader in the cc2538. In `tools/cc2538-bsl/` you can find `cc2538-bsl.py` this is a python script that can download firmware to your node via a serial connection. If you use this option you just need to make sure you have a working version of python installed. You can read the README in the same directory for more info. (serial)</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;* On Linux:</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    * Nodes can be programmed with TI&#39;s [UniFlash] tool. With UniFlash, use the file with `.elf` extension. (jtag + serial)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    * Nodes can also be programmed via the serial boot loader in the cc2538. No extra software needs to be installed. (serial)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;* On OSX:</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    * The `cc2538-bsl.py` script in `tools/cc2538-bsl/` is the only option. No extra software needs to be installed. (serial)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;The file with a `.cc2538dk` extension is a copy of the `.elf` file.</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;Use the Port</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;============</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;The following examples are intended to work off-the-shelf:</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;* Examples under `examples/cc2538dk`</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;* Border router: `examples/ipv6/rpl-border-router`</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;* Webserver: `examples/webserver-ipv6`</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;We can also use the CoAP example from `examples/er-rest-example/`. However, the example&#39;s `Makefile` is slightly problematic at the time of writing this guide. As a workaround, open it and delete this entire block:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    ifneq ($(TARGET), minimal-net)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    ifneq ($(TARGET), native)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    ifneq ($(TARGET), econotag)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    ifneq ($(findstring avr,$(TARGET)), avr)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    PROJECT_SOURCEFILES += static-routing.c</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    endif</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    endif</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    endif</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    endif</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;The key is to prevent compilation of `static-routing.c`. If you&#39;re curious about more info, see the discussion here:</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;&lt;http://thread.gmane.org/gmane.os.contiki.devel/16543&gt;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;and the related bug report here:</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;&lt;https://github.com/contiki-os/contiki/issues/87&gt;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;Build your First Examples</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;-------------------------</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;It is recommended to start with the `cc2538-demo` and `timer-test` examples under `examples/cc2538dk/`. These are very simple examples which will help you get familiar with the hardware and the environment.</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;Strictly speaking, to build them you need to run `make TARGET=cc2538dk`. However, the example directories contain a `Makefile.target` which is automatically included and specifies the correct `TARGET=` argument. Thus, for examples under the `cc2538dk` directory, you can simply run `make`.</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;If you want to upload the compiled firmware to a node via the serial boot loader you need to manually enable the boot loader and then use `make cc2538-demo.upload`. On the SmartRF06 board you enable the boot loader by resetting the board (EM RESET button) while holding the `select` button. (The boot loader backdoor needs to be enabled on the chip for this to work, see README in the `tools/cc2538-bsl` directory for more info)</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;For the `cc2538-demo`, the comments at the top of `cc2538-demo.c` describe in detail what the example does.</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;To generate an assembly listing of the compiled firmware, run `make cc2538-demo.lst`. This may be useful for debugging or optimizing your application code. To intersperse the C source code within the assembly listing, you must instruct the compiler to include debugging information by adding `CFLAGS += -g` to the project Makefile and rebuild by running `make clean cc2538-demo.lst`.</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;Node IEEE/RIME/IPv6 Addresses</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;-----------------------------</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;Nodes will generally autoconfigure their IPv6 address based on their IEEE address. The IEEE address can be read directly from the CC2538 Info Page, or it can be hard-coded. Additionally, the user may specify a 2-byte value at build time, which will be used as the IEEE address&#39; 2 LSBs.</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;To configure the IEEE address source location (Info Page or hard-coded), use the `IEEE_ADDR_CONF_HARDCODED` define in contiki-conf.h:</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;* 0: Info Page</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;* 1: Hard-coded</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;If `IEEE_ADDR_CONF_HARDCODED` is defined as 1, the IEEE address will take its value from the `IEEE_ADDR_CONF_ADDRESS` define. If `IEEE_ADDR_CONF_HARDCODED` is defined as 0, the IEEE address can come from either the primary or secondary location in the Info Page. To use the secondary address, define `IEEE_ADDR_CONF_USE_SECONDARY_LOCATION` as 1.</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;Additionally, you can override the IEEE&#39;s 2 LSBs, by using the `NODEID` make variable. The value of `NODEID` will become the value of the `IEEE_ADDR_NODE_ID` pre-processor define. If `NODEID` is not defined, `IEEE_ADDR_NODE_ID` will not get defined either. For example:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    make NODEID=0x79ab</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;This will result in the 2 last bytes of the IEEE address getting set to 0x79 0xAB</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;Note: Some early production devices do not have am IEEE address written on the Info Page. For those devices, using value 0 above will result in a Rime address of all 0xFFs. If your device is in this category, define `IEEE_ADDR_CONF_HARDCODED` to 1 and specify `NODEID` to differentiate between devices.</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;### Scripted multi-image builds</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;You can build multiple nodes with different `NODEID`s sequentially. The only platform file relying on the value of `NODEID` (or more accurately `IEEE_ADDR_NODE_ID`) is `ieee-addr.c`, which will get recompiled at each build invocation. As a result, the build system can be scripted to build multiple firmware images, each one with a different MAC address. Bear in mind that, if you choose to do such scripting, you will need to make a copy of each firmware before invoking the next build, since each new image will overwrite the previous one. Thus, for example, you could do something like this:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    for image in 1 2 3 4; do make cc2538-demo NODEID=$image &amp;&amp; \</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    cp cc2538-demo.cc2538dk cc2538-demo-$image.cc2538dk; done</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;Which would build `cc2538-demo-1.cc2538dk`, `cc2538-demo-2.cc2538dk` etc</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;As discussed above, only `ieee-addr.c` will get recompiled for every build. Thus, if you start relying on the value of `IEEE_ADDR_NODE_ID` in other code modules, this trick will not work off-the-shelf. In a scenario like that, you would have to modify your script to touch those code modules between every build. For instance, if you are using an imaginary `foo.c` which needs to see changes to `NODEID`, the script above could be modified like so:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    for image in 1 2 3 4; do make cc2538-demo NODEID=$image &amp;&amp; \</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    cp cc2538-demo.cc2538dk cc2538-demo-$image.cc2538dk &amp;&amp; \</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    touch foo.c; done</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;Build a 6LoWPAN Testbed</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;-----------------------</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;Once you are familiar with the basics, get a mini 6LoWPAN testbed.</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;Start by building a border router from `examples/ipv6/rpl-border-router`</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  * Turn on debugging output by changing `#define DEBUG DEBUG_NONE` to `#define DEBUG DEBUG_PRINT` in `border-router.c`.</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  * The border router&#39;s configuration (`project-conf.h`), sets the maximum size of the uIP buffer (`UIP_CONF_BUFFER_SIZE`). This is a bit restrictive for this platform: we can afford to allocate more memory of we want to. It&#39;s not necessary, but feel free to remove the lines below from `project-conf.h`, allowing the platform to use its own default value.</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        #ifndef UIP_CONF_BUFFER_SIZE</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        #define UIP_CONF_BUFFER_SIZE    140</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        #endif</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  * `make TARGET=cc2538dk`</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  * Flash your device with `border-router.cc2538dk` or `border-router.bin`.</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  * Connect device to Linux or OS X over its XDS port.</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  * `cd $(CONTIKI)/tools`</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  * `make tunslip6`</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  * `sudo $(CONTIKI)/tools/tunslip6 -s /dev/&lt;device&gt; fd00::1/64`</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  * The router will print its own IPv6 address. Use it below.</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        Got configuration message of type P</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        Setting prefix fd00::</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        created a new RPL dag</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        Server IPv6 addresses:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         fd00::212:4b00:89ab:cdef</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         fe80::212:4b00:89ab:cdef</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  * `ping6 &lt;address&gt;`</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  * `curl -g &quot;http://[&lt;address-inside-the-brackets&gt;]&quot;` and the border router will serve you a web-page. Try from a browser too.</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;Afterwards, build RPL nodes in `examples/cc2538dk/udp-ipv6-echo-server`</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  * If you are not reading node MAC addresses from the Info Page, make sure you assign a new MAC address for each node by passing `NODEID=xyz` to the make command line, as discussed in an earlier section.</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  * `make` (or `make NODEID=xyz`). You don&#39;t need to specify `TARGET=` as this is saved in `Makefile.target`</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  * Flash device with `udp-echo-server.cc2538dk` or `.bin`.</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  * If you want to see console output, connect the device to a PC over its XDS port. You don&#39;t need to do that though, this example will work on &#39;headless&#39; nodes. This may be a good chance to try out your BB, if you have one.</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  * Repeat for more nodes, each one with a new `NODEID` if necessary.</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;More things to play around with</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  * Feel free to throw some webservers in the mix. In `examples/webserver-ipv6`, run `make TARGET=cc2538dk NODEID=&lt;value&gt;`</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  * `ping6` and `netcat` the RPL nodes (the echo server listens on UDP 3000): `nc -6u &lt;address&gt; 3000`</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  * Retrieve a webpage from a node. Use `curl` as above, or you can `wget` or you can fire up a browser and navigate to the websever&#39;s address.</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;Build a Sniffer - Live Traffic Capture with Wireshark</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;-----------------------------------------------------</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;There is a sniffer example in `examples/sensniff/`</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;Diverging from platform defaults, this example configures the UART to use a baud rate of 460800. The reason is that sniffers operating at 115200 are liable to corrupt frames. This is almost certain to occur when sniffing a ContikiMAC-based deployment. See more details on how to configure UART baud rates in the &quot;Advanced Topics&quot; section.</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;Once you have built it and flashed your device, download and run `sensniff` on your PC (Linux or OS X). Get it from:</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;&lt;https://github.com/g-oikonomou/sensniff&gt;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;Instructions on what to do with `sensniff` are in its README. Make sure to set the `-b` command line parameter correctly to match the sniffer&#39;s UART baud rate. Lastly, bear in mind that Host-to-Peripheral commands will not work with the CC2538 at this stage.</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;Mix &amp; Match with CC2530s</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;------------------------</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;Every aspect of the CC2538 port is interoprable with the existing CC2530 port. Same 6LoWPAN prefix, same .15.4 channel and PAN ID etc. Thus, you can throw in CC2530s at will, for as long as you are using NullRDC. For instance, you can have a CC2531 border router with SmartRF06 + CC2538 EMs as RPL nodes. Or you can have a CC2538 border router with SmartRF05 + CC2530EM RPL nodes etc.</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;If you want to add CC2530s to the network, make sure you have followed the CC2530 how-to on the main contiki wiki:</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;&lt;https://github.com/contiki-os/contiki/wiki/8051-Based-Platforms&gt;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;Advanced Topics</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;===============</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;The platform&#39;s functionality can be customised by tweaking the various configuration directives in `platform/cc2538dk/contiki-conf.h`. Bear in mind that defines specified in `contiki-conf.h` can be over-written by defines specified in `project-conf.h`, which is a file commonly encountered in example directories.</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;Thus, if you want to modify the platform&#39;s default behaviour, change values in `contiki-conf.h`. If you want to configure custom behaviour for a specific example, modify this example&#39;s `project-conf.h`.</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;N.B. Some defines in `contiki-conf.h` are not meant to be modified.</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;Switching between UART and USB (CDC-ACM)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;----------------------------------------</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;By default, everything is configured to use the UART (stdio, border router&#39;s SLIP, sniffer&#39;s output stream). If you want to change this, these are the relevant lines in contiki-conf.h (0: UART, 1: USB):</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    #define SLIP_ARCH_CONF_USB          0 /** SLIP over UART by default */</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    #define DBG_CONF_USB                0 /** All debugging over UART by default */</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;You can multiplex things (for instance, SLIP as well as debugging over USB or SLIP over USB but debugging over UART and other combinations).</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;Selecting UART0 and/or UART1</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;----------------------------</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;By default, everything is configured to use the UART0 (stdio, border router&#39;s SLIP, sniffer&#39;s output stream). If you want to change this, these are the relevant lines in contiki-conf.h (0: UART0, 1: UART1):</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    #define SERIAL_LINE_CONF_UART       0</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    #define SLIP_ARCH_CONF_UART         0</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    #define DBG_CONF_UART               0</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    #define UART1_CONF_UART             0</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;A single UART is available on CC2538DK, so all the configuration values above should be the same (i.e. either all 0 or all 1), but 0 and 1 could be mixed for other CC2538-based platforms supporting 2 UARTs.</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;The chosen UARTs must have their ports and pins defined in board.h:</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    #define UART0_RX_PORT            GPIO_A_NUM</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    #define UART0_RX_PIN             0</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    #define UART0_TX_PORT            GPIO_A_NUM</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    #define UART0_TX_PIN             1</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;Only the UART ports and pins implemented on the board can be defined.</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;UART Baud Rate</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;--------------</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;By default, the CC2538 UART is configured with a baud rate of 115200. It is easy to increase this to 230400 by changing the value of `UART0_CONF_BAUD_RATE` or `UART1_CONF_BAUD_RATE` in `contiki-conf.h` or `project-conf.h`, according to the UART instance used.</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    #define UART0_CONF_BAUD_RATE 230400</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    #define UART1_CONF_BAUD_RATE 230400</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;RF and USB DMA</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;--------------</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;Transfers between RAM and the RF and USB will be conducted with DMA. If for whatever reason you wish to disable this, here are the relevant configuration lines.</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    #define USB_ARCH_CONF_DMA                    1</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    #define CC2538_RF_CONF_TX_USE_DMA            1</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    #define CC2538_RF_CONF_RX_USE_DMA            1</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;Low-Power Modes</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;---------------</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;The CC2538 port supports power modes for low energy consumption. The SoC will enter a low power mode as part of the main loop when there are no more events to service.</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;LPM support can be disabled in its entirety by setting `LPM_CONF_ENABLE` to 0 in `contiki-conf.h` or `project-conf.h`.</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;NOTE: If you are using PG2 version of the Evaluation Module, the SoC will refuse to enter Power Modes 1+ if the debugger is connected and will always enter PM0 regardless of configuration. In order to get real low power mode functionality, make sure the debugger is disconnected. The Battery Board is ideal to test this.</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;The Low-Power module uses a simple heuristic to determine the best power mode, depending on anticipated Deep Sleep duration and the state of various peripherals.</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;In a nutshell, the algorithm first answers the following questions:</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;* Is the RF off?</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;* Are all registered peripherals permitting PM1+?</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;* Is the Sleep Timer scheduled to fire an interrupt?</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;If the answer to any of the above question is &quot;No&quot;, the SoC will enter PM0. If the answer to all questions is &quot;Yes&quot;, the SoC will enter one of PMs 0/1/2 depending on the expected Deep Sleep duration and subject to user configuration and application requirements.</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;At runtime, the application may enable/disable some Power Modes by making calls to `lpm_set_max_pm()`. For example, to avoid PM2 an application could call `lpm_set_max_pm(1)`. Subsequently, to re-enable PM2 the application would call `lpm_set_max_pm(2)`.</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;The LPM module can be configured with a hard maximum permitted power mode.</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    #define LPM_CONF_MAX_PM        N</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;Where N corresponds to the PM number. Supported values are 0, 1, 2. PM3 is not supported. Thus, if the value of the define is 1, the SoC will only ever enter PMs 0 or 1 but never 2 and so on.</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;The configuration directive `LPM_CONF_MAX_PM` sets a hard upper boundary. For instance, if `LPM_CONF_MAX_PM` is defined as 1, calls to `lpm_set_max_pm()` can only enable/disable PM1. In this scenario, PM2 can not be enabled at runtime.</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;When setting `LPM_CONF_MAX_PM` to 0 or 1, the entire SRAM will be available. Crucially, when value 2 is used the linker will automatically stop using the SoC&#39;s SRAM non-retention area, resulting in a total available RAM of 16MB instead of 32MB.</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;### LPM and Duty Cycling Driver</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;LPM is highly related to the operations of the Radio Duty Cycling (RDC) driver of the Contiki network stack and will work correctly with ContikiMAC and NullRDC.</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;* With ContikiMAC, PMs 0/1/2 are supported subject to user configuration.</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;* When NullRDC is in use, the radio will be always on. As a result, the algorithm discussed above will always choose PM0 and will never attempt to drop to PM1/2.</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;Build headless nodes</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;--------------------</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;It is possible to turn off all character I/O for nodes not connected to a PC. Doing this will entirely disable the UART as well as the USB controller, preserving energy in the long term. The define used to achieve this is (1: Quiet, 0: Normal output):</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    #define CC2538_CONF_QUIET      0</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;Setting this define to 1 will automatically set the following to 0:</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;* `USB_SERIAL_CONF_ENABLE`</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;* `UART_CONF_ENABLE`</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;* `STARTUP_CONF_VERBOSE`</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;Code Size Optimisations</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;-----------------------</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;The build system currently uses optimization level `-Os`, which is controlled indirectly through the value of the `SMALL` make variable. This value can be overridden by example makefiles, or it can be changed directly in `platform/cc2538dk/Makefile.cc2538dk`.</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;Historically, the `-Os` flag has caused problems with some toolchains. If you are using one of the toolchains documented in this README, you should be able to use it without issues. If for whatever reason you do come across problems, try setting `SMALL=0` or replacing `-Os` with `-O2` in `cpu/cc2538/Makefile.cc2538`.</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;Doxygen Documentation</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;=====================</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;This port&#39;s code has been documented with doxygen. To build the documentation, navigate to `$(CONTIKI)/doc` and run `make`. This will build the entire contiki documentation and may take a while.</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;If you want to build this platform&#39;s documentation only and skip the remaining platforms, run this:</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    make basedirs=&quot;platform/cc2538dk core cpu/cc2538 examples/cc2538dk&quot;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;Once you&#39;ve built the docs, open `$(CONTIKI)/doc/html/index.html` and enjoy.</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;Other Versions of this Guide</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;============================</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;If you prefer this guide in other formats, use the excellent [pandoc] to convert it.</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;* **pdf**: `pandoc -s --toc README.md -o README.pdf`</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;* **html**: `pandoc -s --toc README.md -o README.html`</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;More Reading</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;============</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;1. [SmartRF06 Evaluation Board User&#39;s Guide, (SWRU321)][smart-rf-ug]</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;2. [CC2538 System-on-Chip Solution for 2.4-GHz IEEE 802.15.4 and ZigBee&amp;reg;/ZigBee IP&amp;reg; Applications, (SWRU319B)][cc2538]</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;[smart-rf-studio]: http://www.ti.com/tool/smartrftm-studio &quot;SmartRF Studio&quot;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;[smart-rf-flashprog]: http://www.ti.com/tool/flash-programmer &quot;SmartRF Flash Programmer&quot;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;[smart-rf-ug]: http://www.ti.com/litv/pdf/swru321a     &quot;SmartRF06 Evaluation Board User&#39;s Guide&quot;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;[cc2538]: http://www.ti.com/product/cc2538     &quot;CC2538&quot;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;[uniflash]: http://processors.wiki.ti.com/index.php/Category:CCS_UniFlash &quot;UniFlash&quot;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;[pandoc]: http://johnmacfarlane.net/pandoc/ &quot;Pandoc - a universal document converter&quot;</div></div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jun 10 2017 20:13:49 for Controller by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
